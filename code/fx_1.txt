// Chispas de impacto (Reemplaza al BulletPuff original)
class Bullet_sparks : BulletPuff replaces BulletPuff
{
    Default
    {
        +NOBLOCKMAP
        +NOGRAVITY
        +ALLOWPARTICLES
        +RANDOMIZE
        RenderStyle "add";
        Alpha 1.0;
        Scale 0.5;
        // Esta línea es la clave:
        Decal "bullet_decal"; 
    }

    States
    {
    Spawn:
        TNT1 A 0 NoDelay A_Jump(255, "Spark1", "Spark2");
        Stop;
    Spark1:
        SPA1 ABCDEFGHIJ 1 Bright;
        Stop; // El sprite de la chispa desaparece rápido
    Spark2:
        SPA2 ABCDEFGHIJ 1 Bright;
        Stop;
    }
}

//ground slam effect 1
class Ground_Slam : actor
{
	default
	{
		+noblockmap
		+CLIENTSIDEONLY
		+NOGRAVITY
        +DONTSPLASH
	}
	states
	{
	spawn:
		SLAM ABCDE 2;
		slam FGH 3 a_fadeout(0.004);
		slam IJ 4 a_fadeout(0.004);
		stop;
	}
}

// Casquillo de bala (Rifle/Machinegun)
class balavacia : Actor
{
    Default
    {
        Height 2;
        Radius 2;
        Speed 6;
        Scale 0.2;
        +DOOMBOUNCE
        -CANBOUNCEWATER
        -NOGRAVITY
        +WINDTHRUST
        +CLIENTSIDEONLY
        +MOVEWITHSECTOR
        +MISSILE
        +NOBLOCKMAP
        -DROPOFF
        +NOTELEPORT
        +FORCEXYBILLBOARD
        +NOTDMATCH
        +GHOST
        +FLOORCLIP
        +THRUACTORS
        Mass 0;
        BounceFactor 0.3;
        DeathSound "weapons/casing";
        BounceSound "weapons/casing";
    }

    States
    {
    Spawn:
        TNT1 A 0 NoDelay;
        CAS2 KKLLGGIIHHEEJJLLMMNNHHEEJJLLMMNN 1;
        CAS2 KKLLGGIIHHEEJJLLMMNNHHEEJJLLMMNN 1;
        Stop;
    Death:
        TNT1 A 0 A_Jump(256, "Rest1", "Rest2", "Rest3", "Rest4");
        Goto Rest1;
    Rest1:
        CAS2 A 200;
        CAS2 A 1;
        stop;
    Rest2:
        CAS2 B 200;
        CAS2 B 1;
        stop;
    Rest3:
        CAS2 C 200;
        CAS2 C 1;
        stop;
    Rest4:
        CAS2 D 200;
        CAS2 D 1;
        stop;
    }
}

// Generador de casquillos de Rifle
class RifleCaseSpawn : Actor
{
    Default
    {
        Speed 20;
        Projectile;
        +NOCLIP
        +CLIENTSIDEONLY
    }
    States
    {
    Spawn:
        TNT1 A 0 NoDelay;
        TNT1 A 1 A_SpawnItemEx("balavacia", 1, 0, 0, random(-8, -10), 0, random(4, 8), random(80, 100)); 
        // Nota: A_CustomMissile se puede usar, pero A_SpawnItemEx es más preciso en ZScript para casquillos.
        Stop;
    }
}

// Cartucho vacío (Escopeta)
class cartuchovacio : Actor
{
    Default
    {
        Height 2;
        Radius 2;
        Speed 6;
        Scale 0.4;
        +DOOMBOUNCE
        -CANBOUNCEWATER
        -NOGRAVITY
        +WINDTHRUST
        +CLIENTSIDEONLY
        +MOVEWITHSECTOR
        +MISSILE
        +NOBLOCKMAP
        -DROPOFF
        +NOTELEPORT
        +FORCEXYBILLBOARD
        +NOTDMATCH
        +GHOST
        +FLOORCLIP
        +THRUACTORS
        Mass 0;
        BounceFactor 0.3;
        DeathSound "weapons/casing";
        BounceSound "weapons/casing";
    }

    States
    {
    Spawn:
        TNT1 A 0 NoDelay;
        CAS1 IIJJGGHHIIJJGGHHIIJJGGHHIIJJGGHH 1;
        CAS1 IIJJGGHHIIJJGGHHIIJJGGHHIIJJGGHH 1;
        Stop;
    Death:
        TNT1 A 0 A_Jump(256, "Rest1", "Rest2", "Rest3", "Rest4", "Rest5", "Rest6");
        Goto Rest1;
    Rest1:
        CAS1 A 200;
        CAS1 A 1;
        stop;
    Rest2:
        CAS1 B 200;
        CAS1 B 1;
        stop;
    Rest3:
        CAS1 C 200;
        CAS1 C 1;
        stop;
    Rest4:
        CAS1 D 200;
        CAS1 D 1;
        stop;
    Rest5:
        CAS1 E 200;
        CAS1 E 1;
        stop;
    Rest6:
        CAS1 F 200;
        CAS1 F 1;
        stop;
    }
}

// Generador de casquillos de Escopeta
class shotgunCaseSpawn : Actor
{
    Default
    {
        Speed 20;
        Projectile;
        +NOCLIP
        +CLIENTSIDEONLY
    }
    States
    {
    Spawn:
        TNT1 A 0 NoDelay;
        TNT1 A 1 A_SpawnItemEx("cartuchovacio", 1, 0, 0, random(-8, -10), 0, random(4, 8), random(-80, -100));
        Stop;
    }
}